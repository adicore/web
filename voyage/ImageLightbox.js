(function(j,m,d,b){var g=function(){var a=d.body||d.documentElement,a=a.style;if(a.WebkitTransition==""){return"-webkit-"}if(a.MozTransition==""){return"-moz-"}if(a.OTransition==""){return"-o-"}if(a.transition==""){return""}return false},p=g()===false?false:true,c=function(o,a,q){var i={},f=g();i[f+"transform"]="translateX("+a+")";i[f+"transition"]=f+"transform "+q+"s linear";o.css(i)},l="ontouchstart" in m,k=m.navigator.pointerEnabled||m.navigator.msPointerEnabled,h=function(a){if(l){return true}if(!k||typeof a==="undefined"||typeof a.pointerType==="undefined"){return false}if(typeof a.MSPOINTER_TYPE_MOUSE!=="undefined"){if(a.MSPOINTER_TYPE_MOUSE!=a.pointerType){return true}}else{if(a.pointerType!="mouse"){return true}}return false};j.fn.imageLightbox=function(a){var a=j.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:true,enableKeyboard:true,quitOnEnd:false,quitOnImgClick:false,quitOnDocClick:true,onStart:false,onEnd:false,onLoadStart:false,onLoadEnd:false},a),o=j([]),n=j(),u=j(),q=0,e=0,t=0,B=false,f=function(i){return j(i).prop("tagName").toLowerCase()=="a"&&(new RegExp(".("+a.allowedTypes+")$","i")).test(j(i).attr("href"))},s=function(){if(!u.length){return true}var y=j(m).width()*0.8,w=j(m).height()*0.9,v=new Image;v.src=u.attr("src");v.onload=function(){q=v.width;e=v.height;if(q>y||e>w){var i=q/e>y/w?q/y:e/w;q/=i;e/=i}u.css({width:q+"px",height:e+"px",top:(j(m).height()-e)/2+"px",left:(j(m).width()-q)/2+"px"})}},z=function(i){if(B){return false}i=typeof i==="undefined"?false:i=="left"?1:-1;if(u.length){if(i!==false&&(o.length<2||a.quitOnEnd===true&&(i===-1&&o.index(n)==0||i===1&&o.index(n)==o.length-1))){A();return false}var r={opacity:0};if(p){c(u,100*i-t+"px",a.animationSpeed/1000)}else{r.left=parseInt(u.css("left"))+100*i+"px"}u.animate(r,a.animationSpeed,function(){x()});t=0}B=true;if(a.onLoadStart!==false){a.onLoadStart()}setTimeout(function(){u=j("<img "+a.selector+" />").attr("src",n.attr("href")).load(function(){u.appendTo("body");s();var E={opacity:1};u.css("opacity",0);if(p){c(u,-100*i+"px",0);setTimeout(function(){c(u,0+"px",a.animationSpeed/1000)},50)}else{var D=parseInt(u.css("left"));E.left=D+"px";u.css("left",D-100*i+"px")}u.animate(E,a.animationSpeed,function(){B=false;if(a.onLoadEnd!==false){a.onLoadEnd()}});if(a.preloadNext){var C=o.eq(o.index(n)+1);if(!C.length){C=o.eq(0)}j("<img />").attr("src",C.attr("href")).load()}}).error(function(){if(a.onLoadEnd!==false){a.onLoadEnd()}});var y=0,v=0,w=0;u.on(k?"pointerup MSPointerUp":"click",function(D){D.preventDefault();if(a.quitOnImgClick){A();return false}if(h(D.originalEvent)){return true}var C=(D.pageX||D.originalEvent.pageX)-D.target.offsetLeft;n=o.eq(o.index(n)-(q/2>C?1:-1));if(!n.length){n=o.eq(q/2>C?o.length:0)}z(q/2>C?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(C){if(!h(C.originalEvent)||a.quitOnImgClick){return true}if(p){w=parseInt(u.css("left"))}y=C.originalEvent.pageX||C.originalEvent.touches[0].pageX}).on("touchmove pointermove MSPointerMove",function(C){if(!h(C.originalEvent)||a.quitOnImgClick){return true}C.preventDefault();v=C.originalEvent.pageX||C.originalEvent.touches[0].pageX;t=y-v;if(p){c(u,-t+"px",0)}else{u.css("left",w-t+"px")}}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(C){if(!h(C.originalEvent)||a.quitOnImgClick){return true}if(Math.abs(t)>50){n=o.eq(o.index(n)-(t<0?1:-1));if(!n.length){n=o.eq(t<0?o.length:0)}z(t>0?"right":"left")}else{if(p){c(u,0+"px",a.animationSpeed/1000)}else{u.animate({left:w+"px"},a.animationSpeed/2)}}})},a.animationSpeed+100)},x=function(){if(!u.length){return false}u.remove();u=j()},A=function(){if(!u.length){return false}u.animate({opacity:0},a.animationSpeed,function(){x();B=false;if(a.onEnd!==false){a.onEnd()}})};j(m).on("resize",s);if(a.quitOnDocClick){j(d).on(l?"touchend":"click",function(i){if(u.length&&!j(i.target).is(u)){A()}})}if(a.enableKeyboard){j(d).on("keyup",function(i){if(!u.length){return true}i.preventDefault();if(i.keyCode==27){A()}if(i.keyCode==37||i.keyCode==39){n=o.eq(o.index(n)-(i.keyCode==37?1:-1));if(!n.length){n=o.eq(i.keyCode==37?o.length:0)}z(i.keyCode==37?"left":"right")}})}j(d).on("click",this.selector,function(i){if(!f(this)){return true}i.preventDefault();if(B){return false}B=false;if(a.onStart!==false){a.onStart()}n=j(this);z()});this.each(function(){if(!f(this)){return true}o=o.add(j(this))});this.switchImageLightbox=function(r){var i=o.eq(r);if(i.length){var v=o.index(n);n=i;z(r<v?"left":"right")}return this};this.quitImageLightbox=function(){A();return this};return this}})(jQuery,window,document);$(function(){var h=function(){$('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},i=function(){$("#imagelightbox-loading").remove()},n=function(){$('<div id="imagelightbox-overlay"></div>').appendTo("body")},k=function(){$("#imagelightbox-overlay").remove()},b=function(p){$('<button type="button" id="imagelightbox-close" title="Close"></button>').appendTo("body").on("click touchend",function(){$(this).remove();p.quitImageLightbox();return false})},o=function(){$("#imagelightbox-close").remove()},e=function(){var p=$('a[href="'+$("#imagelightbox").attr("src")+'"] img');var q="No Caption";if($(p).is("[alt]")){q=$(p).attr("alt")}$('<div id="imagelightbox-caption">'+q+"</div>").appendTo("body")},g=function(){$("#imagelightbox-caption").remove()},a=function(r,q){var p=$(q);if(p.length){var u=$('<div id="imagelightbox-nav"></div>');for(var t=0;t<p.length;t++){u.append('<button type="button"></button>')}u.appendTo("body");u.on("click touchend",function(){return false});var s=u.find("button");s.on("click touchend",function(){var v=$(this);if(p.eq(v.index()).attr("href")!=$("#imagelightbox").attr("src")){r.switchImageLightbox(v.index())}s.removeClass("active");s.eq(v.index()).addClass("active");return false}).on("touchend",function(){return false})}},m=function(p){var q=$("#imagelightbox-nav button");q.removeClass("active");q.eq($(p).filter('[href="'+$("#imagelightbox").attr("src")+'"]').index(p)).addClass("active")},l=function(){$("#imagelightbox-nav").remove()},f=function(q,p){var r=$('<button type="button" class="imagelightbox-arrow imagelightbox-arrow-left"></button><button type="button" class="imagelightbox-arrow imagelightbox-arrow-right"></button>');r.appendTo("body");r.on("click touchend",function(v){v.preventDefault();var u=$(this),s=$(p+'[href="'+$("#imagelightbox").attr("src")+'"]'),t=s.index(p);if(u.hasClass("imagelightbox-arrow-left")){t=t-1;if(!$(p).eq(t).length){t=$(p).length}}else{t=t+1;if(!$(p).eq(t).length){t=0}}q.switchImageLightbox(t);return false})},d=function(){$(".imagelightbox-arrow").remove()};var c=".post-body a[href]:has(img)";var j=$(c).imageLightbox({onStart:function(){n();b(j);f(j,c);a(j,c)},onEnd:function(){k();g();o();d();i();l()},onLoadStart:function(){g();h()},onLoadEnd:function(){e();i();$(".imagelightbox-arrow").css("display","block");m(c)}})});
